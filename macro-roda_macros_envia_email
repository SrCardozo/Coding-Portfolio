Sub enviar_reservas()

'Otimiza o código desabilitando atualização de tela e definindo o cálculo das fórmulas como manual
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

'Executa a macro de reservas na planilha de cada assessor
Application.Run "nome_planilha1.xlsm!reservas"
Application.Run "nome_planilha2.xlsm!reservas"
Application.Run "nome_planilha3.xlsm!reservas"

'Salva e fecha a planilha de reservas aberta
Workbooks("RESERVAS.xlsx").Close SaveChanges:=True

'Define o caminho do arquivo que será anexado ao e-mail
anexo = "C:\Users\" & Environ("username") & "\Desktop\RESERVAS.xlsx"

'Cria o e-mail de reservas, anexa o arquivo e envia o e-mail
Set outapp = CreateObject("Outlook.Application")
Set outmail = outapp.CreateItem(0)

On Error Resume Next
With outmail
    .Display
    .To = "reserva@galapagoscapital.com"
    .CC = "farmers@galapagoscapital.com"
    .BCC = ""
    .Subject = "Reservas - " & Date & " " & produto
    .HTMLBody = "Segue em anexo as reservas." & .HTMLBody
    .Attachments.Add anexo
    .send
End With

On Error GoTo 0

Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

'Ativa a planilha atual e avisa quando o código terminar de rodar
ThisWorkbook.Activate
MsgBox "Reservas salvas!", vbInformation

End Sub
